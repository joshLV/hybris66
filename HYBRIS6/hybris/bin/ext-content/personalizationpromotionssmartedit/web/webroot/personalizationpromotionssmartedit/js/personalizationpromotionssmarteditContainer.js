angular.module("personalizationpromotionssmarteditRestServiceModule",["restServiceFactoryModule","personalizationsmarteditCommons"]).factory("personalizationpromotionssmarteditRestService",["restServiceFactory","personalizationsmarteditUtils",function(o,e){var t={};return t.getPromotions=function(t){var n=o.get("/personalizationwebservices/v1/query/cxpromotionsforcatalog"),i=[];(t=t||[]).forEach(function(o,t){e.pushToArrayIfValueExists(i,"catalog"+t,o.catalog),e.pushToArrayIfValueExists(i,"version"+t,o.catalogVersion)});var a={params:{entry:i}};return n.save(a)},t}]),angular.module("personalizationsmarteditPromotionModule",["personalizationsmarteditCommons","personalizationsmarteditRestServiceModule","personalizationsmarteditCommerceCustomizationModule","personalizationpromotionssmarteditRestServiceModule"]).run(["personalizationsmarteditCommerceCustomizationService","$filter",function(o,e){o.registerType({type:"cxPromotionActionData",text:"personalization.modal.commercecustomization.action.type.promotion",template:"personalizationsmarteditPromotionsTemplate.html",confProperty:"personalizationsmartedit.commercecustomization.promotions.enabled",getName:function(o){return e("translate")("personalization.modal.commercecustomization.promotion.display.name")+" - "+o.promotionId}})}]).controller("personalizationsmarteditPromotionController",["$q","$scope","$filter","personalizationsmarteditRestService","personalizationpromotionssmarteditRestService","personalizationsmarteditMessageHandler",function(o,e,t,n,i,a){e.promotion=null,e.availablePromotions=[];var r=function(){var e=o.defer();return n.getPreviewTicket().then(function(o){var t=o.catalogVersions;i.getPromotions(t).then(function(o){e.resolve(o)},function(o){e.reject(o)})},function(o){e.reject(o)}),e.promise},s=function(){r().then(function(o){e.availablePromotions=o.promotions},function(){a.sendError(t("translate")("personalization.error.gettingpromotions"))})},l=function(o){return{type:"cxPromotionActionData",promotionId:o.code}},m=function(o,e){return o.type===e.type&&o.promotionId===e.promotionId};e.promotionSelected=function(o,t){var n=l(o);e.addAction(n,m),t.selected=null},e.isItemInSelectDisabled=function(o){var t=l(o);return e.isItemInSelectedActions(t,m)},e.initUiSelect=function(o){o.isActive=function(){return!1},e.availablePromotions=JSON.parse(JSON.stringify(e.availablePromotions))},s()}]),angular.module("personalizationpromotionssmarteditContainer",["personalizationsmarteditPromotionModule","personalizationpromotionssmarteditContainerTemplates","yjqueryModule"]).run(["yjQuery","domain",function(o,e){!function(e){var t=o("<link rel='stylesheet' type='text/css' href='"+e+"'>");o("head").append(t)}(e+"/personalizationpromotionssmartedit/css/style.css")}]),angular.module("personalizationpromotionssmarteditContainerTemplates",[]).run(["$templateCache",function(o){"use strict";o.put("web/features/personalizationpromotionssmarteditContainer/management/commerceCustomizationView/promotions/personalizationsmarteditPromotionsTemplate.html",'<div data-ng-controller="personalizationsmarteditPromotionController">\n    <label for="promotion-selector-1" class="personalization-modal__label" data-translate="personalization.modal.commercecustomization.promotion.label"></label>\n    <ui-select uis-open-close="initUiSelect($select)" id="promotion-selector-1" class="form-control" data-ng-model="promotion" on-select="promotionSelected($item, $select)" theme="select2" search-enabled="true">\n        <ui-select-match placeholder="{{\'personalization.modal.commercecustomization.promotion.search.placeholder\' | translate}}">\n            <span>{{\'personalization.modal.commercecustomization.promotion.search.placeholder\' | translate}}</span>\n        </ui-select-match>\n        <ui-select-choices repeat="item in availablePromotions | filter: $select.search" ui-disable-choice="isItemInSelectDisabled(item)" position="down">\n            <div class="row ng-scope">\n                <span class="col-md-8" data-ng-bind="item.code"></span>\n                <span class="col-md-4" data-ng-bind="item.promotionGroup"></span>\n            </div>\n        </ui-select-choices>\n    </ui-select>\n</div>')}]);